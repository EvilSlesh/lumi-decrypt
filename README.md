# lumi-decrypt

## 简介

人工桌面文件提取

从人工桌面的数据文件夹中提取视频和封面，自动区分封面文件和视频文件。

## 使用

无参数      - 进行一次初始化，没有配置文件则创建
--decrypt  - 提取视频和封面
-d

可执行文件后面带``` r ```的是需要运行库的版本，因为VS版本比较高，所以需要全套运行库

## 配置文件

程序会从```cmd当前路径```查找配置文件（```lumi-decrypt.ini```)，没有将会创建。第一次创建的配置文件默认会在```cmd当前路径```创建，请使用```cd```命令改变路径。默认的数据文件夹位置是当前程序版本（x86/x64）对应的程序文件夹目录\\N0vaDesktop\\N0vaDesktopCache。默认的保存位置是```cmd当前目录\\lumi```。*建议第一次使用先以无参数运行一次，好让您有机会修改配置文件*

配置文件只有一个节(·```lumi-decrypt```)，里边包括两个键```N0vaPath```和```DecryptPath```

```N0vaPath```指向人工桌面的数据文件夹（理论上lumi-decrypt的遍历足够好，你甚至可以直接设置为C盘目录，但是为了执行效率，请您提供尽量精准的路径，并且这个路径在人工桌面的设置中可以找到）

```DecryptPath```指向提取出来的文件的保存位置，提取出来的文件，在相对路径上和```N0vaPath```内的文件夹保持一致所以尽量精确的文件夹也有助于避免路径的冗长

*程序的某些部分的路径长度要求在260个字符以内，这里是偷了个懒，直接使用了windows定义的宏MAX_PATH,不过根据微软相关文档Unicode版本的API最大长度支持32767个字符，Win10 1607以上甚至可以支持更长的路径。放心lumi-decrypt有全Unicode支持，只做简单的修改就可以（目前我想到的只是把用到的所有MAX_PATH替换为一个更大的值即可，没有实证还不能下结论），对于没有能力改我的代码的只能尝试把路径弄短一点*[微软相关文档](https://docs.microsoft.com/en-us/windows/win32/fileio/naming-a-file)

推荐配置文件中使用绝对路径，相对路径未经测试

## 可用版本

人工桌面主版本 v1.0.0
player v1.0.22
(2020.8.13记录，后续版本可以自己尝试，不定期更新)

## 鸣谢

bilibili用户 - 钾钇鈵钉 UID: 310793182

感谢提供思路

## 声明

此程序和代码仅供研究学习使用，本人不支持将其以任何形式将其用作违法用途
